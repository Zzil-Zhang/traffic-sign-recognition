# GTSRB交通标志识别 - PaddlePaddle CNN模型

基于PaddlePaddle框架实现的CNN交通标志分类模型，专为实时识别设计。本项目采用轻量级网络架构，在保证高精度的同时实现快速推理。

## 项目结构

```
.
├── data_utils.py                    # 数据加载和预处理
├── cnn_model_paddle.py              # CNN模型定义
├── train_cnn_paddle.ipynb           # 主训练脚本（Jupyter）
├── trained_models/                  # 训练好的模型
├── training_results/                # 训练结果和报告
├── training_curves/                 # 训练曲线图
└── processed_data/                  # 预处理数据（来自基准模型）
```

## 核心功能

### 1. 数据加载 (`data_utils.py`)
- 从预处理.npy文件加载德国交通标志数据集
- 支持训练时的数据增强：随机水平翻转（20%概率）、旋转（±5度）、色彩抖动
- 图像归一化：使用ImageNet标准（均值[0.485,0.456,0.406]，标准差[0.229,0.224,0.225]）
- 实时样本可视化功能

### 2. 模型架构 (`cnn_model_paddle.py`)
本项目采用**SimpleCNNPaddle**（简单模型）架构：
- **输入层**：接收64×64×3的RGB图像
- **卷积层1**：32个3×3卷积核，BN归一化，ReLU激活，2×2最大池化
- **卷积层2**：64个3×3卷积核，BN归一化，ReLU激活，2×2最大池化  
- **卷积层3**：128个3×3卷积核，BN归一化，ReLU激活，2×2最大池化
- **全局平均池化**：替代传统展平，显著减少参数量
- **全连接层1**：128个神经元，批归一化，40% Dropout防止过拟合
- **输出层**：43个神经元对应43类交通标志，Softmax分类

**模型特性**：
- 总参数量：116,715（11.6万）
- 轻量设计，适合嵌入式部署
- 理论推理时间＜5ms（GPU环境）

### 3. 训练系统 (`train_cnn_paddle.ipynb`)
- **优化策略**：AdamW优化器（权重衰减0.0005，梯度裁剪1.0）
- **学习率调度**：余弦退火（T_max=30，η_min=1e-5）
- **正则化**：批归一化 + Dropout（全连接层40%）
- **回调机制**：模型检查点 + 早停（耐心15轮，最小改进0.001）
- **完整监控**：训练/验证损失、准确率、学习率曲线

## 训练配置

### 超参数设置
- 训练轮数：50
- 批次大小：32
- 初始学习率：0.001
- 优化器：AdamW（β1=0.9，β2=0.999）
- 数据增强：开启（训练集）/关闭（验证测试集）

### 训练流程
1. 初始化模型和优化器
2. 每轮训练后评估验证集性能
3. 保存最佳模型（基于验证准确率）
4. 早停机制防止过拟合
5. 训练结束加载最佳模型评估测试集

## 性能表现

### 训练结果
- **最佳验证准确率**：99.76%
- **最终测试准确率**：99.61%
- **训练准确率**：97.45%
- **泛化表现**：训练-验证差距-2.54%（验证>训练）

### 鲁棒性分析
- **数据增强效果**：训练集更具挑战性，提升模型鲁棒性
- **正则化有效**：Dropout使训练-验证差距从6.7%降至1.1%
- **无过拟合**：验证准确率始终高于训练准确率
- **收敛稳定**：学习率调度优化训练过程

## 快速开始

### 环境要求
```bash
pip install paddlepaddle==3.3.0 numpy matplotlib tqdm
```

### 运行训练
1. 确保`processed_data/`目录包含预处理数据
2. 打开`train_cnn_paddle.ipynb`执行所有单元格
3. 或运行Python脚本：`python train_cnn_paddle.py`

### 使用预训练模型
```python
import paddle
from cnn_model_paddle import SimpleCNNPaddle

# 加载模型
model = SimpleCNNPaddle(num_classes=43)
model.set_state_dict(paddle.load('trained_models/my_traffic_classifier_paddle.pdparams'))
model.eval()  # 设置为评估模式
```

## 交付内容

1. **模型文件**: `.pdparams` 权重文件
2. **训练曲线**: 损失和准确率变化图
3. **评估报告**: JSON格式的详细报告
4. **日志文件**: 训练过程记录

## 技术亮点

1. **轻量高效**：11.6万参数，适合车载设备部署
2. **鲁棒性强**：数据增强应对光照、视角变化
3. **训练稳定**：早停+正则化防止过拟合
4. **部署友好**：PaddlePaddle框架，支持多种硬件平台
5. **实时识别**：理论推理速度快，满足实时性要求

## 注意事项

1. 需要GPU支持以获得合理训练速度
2. 依赖基准模型生成的预处理数据
3. 默认使用标准模型架构（11.7万参数），可根据需求选择其他模型
4. 训练包含早停和正则化机制，有效防止过拟合
5. 模型针对实时识别优化，适合车载设备部署