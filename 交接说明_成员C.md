# æ•°æ®å¢å¼ºæ¨¡å—ä½¿ç”¨è¯´æ˜

## ğŸ“Œ æ ¸å¿ƒæ–‡ä»¶
- `c_augment_data.py` - æ‰¹é‡å¢å¼ºä¸»ç¨‹åºï¼Œç”Ÿæˆæ­£ç¡®æ•°æ®é›†
- `data_augmentation.py` - å¢å¼ºç®—æ³•åº“ çœ‹å¢å¼ºå›¾ç‰‡æ•ˆæœ

## ğŸ”§ å®‰è£…ä¾èµ–
```bash
pip install numpy opencv-python matplotlib
# å¯é€‰
pip install albumentations torchvision
```

## ğŸš€ ä½¿ç”¨æ­¥éª¤

### 1. å‰ç½®æ¡ä»¶
ç¡®ä¿ `processed_data/` ç›®å½•å·²å­˜åœ¨æˆå‘˜Aå¤„ç†çš„æ•°æ®ï¼š
- `X_train.npy`
- `y_train.npy`

### 2. æ‰§è¡Œå¢å¼ºï¼ˆæˆå‘˜Cï¼‰
```bash
python c_augment_data.py
```
**ç»“æœï¼š**
- `processed_data/X_train_augmented.npy`
- `processed_data/y_train_augmented.npy`
- æ•°æ®é‡ï¼šåŸå§‹æ•°æ®Ã—2

### 3. æµ‹è¯•å¢å¼ºæ•ˆæœï¼ˆå¯é€‰ï¼‰
```bash
python data_augmentation.py
```
ç”Ÿæˆå¯è§†åŒ–å¯¹æ¯”å›¾ `data_augmentation_samples.png`

## ğŸ› ï¸ å¢å¼ºç±»å‹
- **å‡ ä½•å¢å¼º**ï¼šæ—‹è½¬ã€å¹³ç§»ã€ç¼©æ”¾ã€é”™åˆ‡
- **åœºæ™¯å¢å¼º**ï¼šè¿åŠ¨æ¨¡ç³Šã€é›¨æ»´ã€é˜´å½±ã€äº®åº¦è°ƒæ•´
- **ç»„åˆå¢å¼º**ï¼šéšæœºé€‰æ‹©1-3ç§å¢å¼ºç»„åˆ

## ğŸ“Š è¾“å‡º
- å¢å¼ºåæ•°æ®æ ¼å¼ä¸åŸæ•°æ®ç›¸åŒ
- æ ‡ç­¾ä¿æŒä¸å˜ï¼Œæ•°æ®é‡ç¿»å€
- è‡ªåŠ¨å¤„ç†å›¾åƒæ ¼å¼è½¬æ¢ï¼ˆuint8 â†” float32ï¼‰

## âš ï¸ æ³¨æ„äº‹é¡¹
- å›¾åƒå°ºå¯¸å»ºè®®â‰¥64Ã—64
- å¦‚é‡albumentationså¯¼å…¥é”™è¯¯ï¼Œä»å¯ä½¿ç”¨åŸºç¡€å¢å¼ºåŠŸèƒ½

# è¶…å‚æ•°è°ƒä¼˜
è¿è¡Œ`hyperparameter_tuning_final.py`

æœ¬ä»£ç æ˜¯æˆå‘˜Cçš„ä»»åŠ¡ï¼ŒåŸºäºæˆå‘˜Açš„æ•°æ®é¢„å¤„ç†å’Œæˆå‘˜Bçš„CNNæ¨¡å‹è¿›è¡Œè¶…å‚æ•°è°ƒä¼˜ä¸äº¤å‰éªŒè¯ã€‚é€šè¿‡ç³»ç»ŸåŒ–çš„å‚æ•°æœç´¢ï¼Œæ‰¾åˆ°æœ€ä½³æ¨¡å‹é…ç½®ï¼Œæå‡å¾·å›½äº¤é€šæ ‡å¿—è¯†åˆ«å‡†ç¡®ç‡ã€‚

æ ¸å¿ƒåŠŸèƒ½ï¼š
1. å¤ç”¨ç°æœ‰ä»£ç ï¼šç›´æ¥è°ƒç”¨æˆå‘˜Açš„data_preprocessing.pyå’Œæˆå‘˜Bçš„cnn_model.py

2. è¶…å‚æ•°ä¼˜åŒ–ï¼š

    KæŠ˜äº¤å‰éªŒè¯ï¼ˆè¯„ä¼°æ¨¡å‹ç¨³å®šæ€§ï¼‰
    
    éšæœºæœç´¢ï¼ˆæ¢ç´¢å‚æ•°ç©ºé—´ï¼‰
    
    ç³»ç»ŸåŒ–æœç´¢ï¼ˆæµ‹è¯•å…³é”®å‚æ•°ï¼‰
    
    åˆ†å±‚æœç´¢ï¼ˆå…ˆå¿«é€Ÿç­›é€‰ï¼Œå†ç²¾ç»†è°ƒä¼˜ï¼‰

3. å‚æ•°åˆ†æï¼šå¯è§†åŒ–åˆ†æè¶…å‚æ•°å¯¹æ¨¡å‹æ€§èƒ½çš„å½±å“ æœ€ç»ˆè®­ç»ƒï¼šä½¿ç”¨æœ€ä½³å‚æ•°è®­ç»ƒå®Œæ•´æ¨¡å‹

è¶…å‚æ•°è°ƒä¼˜ç»“æœä¿å­˜åœ¨ `hyperparameter_tuning_result/` ç›®å½•ä¸‹ï¼š
```text
hyperparameter_tuning_result/
â”œâ”€â”€ kfold_analysis.png          # KæŠ˜åˆ†æå›¾
â”œâ”€â”€ search_analysis.png         # è¶…å‚æ•°åˆ†æå›¾
â”œâ”€â”€ final_training_curves.png   # Loss/Accuracyæ›²çº¿
â”œâ”€â”€ random_search_results.json  # è¯¦ç»†æœç´¢ç»“æœ
â”œâ”€â”€ search_results.csv          # CSVæ ¼å¼ç»“æœ
â”œâ”€â”€ final_tuning_report.json    # æœ€ç»ˆè®­ç»ƒæŠ¥å‘Š
â””â”€â”€ kfold_results.json          # KæŠ˜ç»“æœ

recommended_parameters_for_memberB.txt  # æ ¹ç›®å½• ç»™æˆå‘˜Bçš„å»ºè®®
traffic_sign_model_tuned_*.keras # æ ¹ç›®å½• è®­ç»ƒå¥½çš„æ¨¡å‹æ–‡ä»¶
```

## è¶…å‚æ•°è°ƒä¼˜èœå•è¯´æ˜
é€‰æ‹©æ¨¡å‹ç±»å‹ï¼šæ ‡å‡†CNNã€ç®€å•CNNæˆ–å‚è€ƒæ¨¡å‹

è¿è¡Œè°ƒä¼˜æ–¹æ³•ï¼š

1. KæŠ˜äº¤å‰éªŒè¯ï¼ˆæ¨è5æŠ˜ï¼‰
2. éšæœºæœç´¢ï¼ˆæ¨è20æ¬¡è¿­ä»£ï¼‰
5. ä½¿ç”¨æœ€ä½³å‚æ•°è®­ç»ƒæœ€ç»ˆæ¨¡å‹
6. æŸ¥çœ‹å½“å‰æœ€ä½³å‚æ•°

è®­ç»ƒæœ€ç»ˆæ¨¡å‹ï¼šä½¿ç”¨æ‰¾åˆ°çš„æœ€ä½³å‚æ•°

å¯¼å‡ºå»ºè®®ï¼šç”Ÿæˆç»™æˆå‘˜Bçš„å‚æ•°é…ç½®æ–‡ä»¶
```text
# æ­¥éª¤1: é€‰æ‹©æ¨¡å‹ç±»å‹
è¯·é€‰æ‹©æ¨¡å‹ç±»å‹ (1/2/3, é»˜è®¤1): 1
è¯·é€‰æ‹©æ¨¡å‹ç±»å‹ (1/2/3, é»˜è®¤1): 1

ğŸ“± è¶…å‚æ•°è°ƒä¼˜èœå•
=====================================================================
1. ğŸ“Š KæŠ˜äº¤å‰éªŒè¯ (è¯„ä¼°æ¨¡å‹ç¨³å®šæ€§)
2. ğŸ” éšæœºæœç´¢ (å¯»æ‰¾æœ€ä½³è¶…å‚æ•°)
3. ğŸ”¬ ç³»ç»ŸåŒ–æœç´¢ (ç³»ç»Ÿæµ‹è¯•å…³é”®å‚æ•°)
4. ğŸ—ï¸  åˆ†å±‚æœç´¢ (æ¨èï¼Œæ›´é«˜æ•ˆ)
5. ğŸš€ ä½¿ç”¨æœ€ä½³å‚æ•°è®­ç»ƒæœ€ç»ˆæ¨¡å‹
6. ğŸ“ˆ æŸ¥çœ‹å½“å‰æœ€ä½³å‚æ•°
7. ğŸ“¤ ç”Ÿæˆç»™æˆå‘˜Bçš„å‚æ•°å»ºè®®
8. ğŸšª é€€å‡º
=====================================================================
è¯·é€‰æ‹© (1-8): 1

æŠ˜æ•° (é»˜è®¤5): 5
æ¯æŠ˜è®­ç»ƒè½®æ•° (é»˜è®¤10): 5
æ‰¹å¤§å° (é»˜è®¤32): 32
... è¿è¡Œ ...
# æ­¥éª¤2: è¿è¡Œéšæœºæœç´¢ï¼ˆå…¨é¢è°ƒä¼˜ï¼‰
## CPUè®­ç»ƒ/æ€§èƒ½ä¸€èˆ¬çš„GPU
è¯·é€‰æ‹© (1-8): 2
è¿­ä»£æ¬¡æ•° (é»˜è®¤20): 20
äº¤å‰éªŒè¯æŠ˜æ•° (é»˜è®¤3): 3
æ¯è½®è®­ç»ƒè½®æ•° (é»˜è®¤5): 5

# æ­¥éª¤3: æŸ¥çœ‹æœ€ä½³å‚æ•°
è¯·é€‰æ‹© (1-8): 6

# æ­¥éª¤4: ä½¿ç”¨æœ€ä½³å‚æ•°è®­ç»ƒï¼ˆç”ŸæˆLoss/Accuracyæ›²çº¿ï¼‰
è¯·é€‰æ‹© (1-8): 5
è®­ç»ƒè½®æ•° (é»˜è®¤30): 25

# æ­¥éª¤5: ç”Ÿæˆå»ºè®®æŠ¥å‘Š
è¯·é€‰æ‹© (1-8): 7

# æ­¥éª¤6: é€€å‡º
è¯·é€‰æ‹© (1-8): 8
```

å›¾è¡¨1: KæŠ˜äº¤å‰éªŒè¯åˆ†æå›¾ (kfold_analysis.png)
å·¦ä¾§: å„æŠ˜å‡†ç¡®ç‡æŸ±çŠ¶å›¾

å³ä¾§: å„æŠ˜éªŒè¯å‡†ç¡®ç‡æ›²çº¿

æ˜¾ç¤º: æ¨¡å‹ç¨³å®šæ€§ã€æ–¹å·®å¤§å°

å›¾è¡¨2: è¶…å‚æ•°æœç´¢ç»“æœåˆ†æå›¾ (search_analysis.png)
åŒ…å«å››ä¸ªå­å›¾ï¼š

å­¦ä¹ ç‡ vs å‡†ç¡®ç‡ (æ•£ç‚¹å›¾ + logå°ºåº¦)

æ‰¹å¤§å° vs å‡†ç¡®ç‡ (æ•£ç‚¹å›¾)

ä¼˜åŒ–å™¨å¯¹æ¯” (æŸ±çŠ¶å›¾)

Dropoutç‡ç»„åˆå½±å“ (äºŒç»´æ•£ç‚¹å›¾ï¼Œé¢œè‰²è¡¨ç¤ºå‡†ç¡®ç‡)

å›¾è¡¨3: æœ€ç»ˆè®­ç»ƒæ›²çº¿ (final_training_curves.png)
å·¦ä¾§: è®­ç»ƒ/æµ‹è¯•å‡†ç¡®ç‡æ›²çº¿

å³ä¾§: è®­ç»ƒ/æµ‹è¯•æŸå¤±æ›²çº¿

æ˜¾ç¤º: æ”¶æ•›è¿‡ç¨‹ã€æ˜¯å¦è¿‡æ‹Ÿåˆ

### è¶…å‚æ•°è°ƒä¼˜æ—¥å¿—
2025-12-22 
```bash
D:\software\python\anaconda3\envs\traffic-sign-recognition\python.exe D:\python\pythonProject\traffic-sign-recognition-learn\hyperparameter_tuning_advanced.py 
TensorFlowç‰ˆæœ¬: 2.13.0
======================================================================
äº¤é€šæ ‡å¿—CNNæ¨¡å‹ - é«˜çº§è¶…å‚æ•°è°ƒä¼˜
======================================================================
Bçš„åŸºçº¿å‡†ç¡®ç‡: 0.997450
Bçš„åŸºçº¿å‚æ•°: å­¦ä¹ ç‡=0.001, æ‰¹å¤§å°=32, ä¼˜åŒ–å™¨=Adam, Dropout=0.25/0.5

[1] åŠ è½½é¢„å¤„ç†æ•°æ®...
âœ“ è®­ç»ƒæ•°æ®: (27446, 64, 64, 3), æ ·æœ¬æ•°: 27446

[3] å¼€å§‹è¶…å‚æ•°è°ƒä¼˜ (KæŠ˜äº¤å‰éªŒè¯)...
    æ¯ä¸ªå‚æ•°ç»„åˆè¿›è¡Œ 3 æŠ˜éªŒè¯
    æ¯æŠ˜æœ€å¤šè®­ç»ƒ 15 ä¸ªepochs
----------------------------------------------------------------------

[2] è®¾è®¡è¶…å‚æ•°å®éªŒæ–¹æ¡ˆ...
  å®éªŒç»„1: å­¦ä¹ ç‡è°ƒä¼˜ (Bçš„åŸºçº¿: 0.001)
  å®éªŒç»„2: æ‰¹å¤§å°è°ƒä¼˜ (Bçš„åŸºçº¿: 32)
  å®éªŒç»„3: ä¼˜åŒ–å™¨å¯¹æ¯” (Bçš„åŸºçº¿: Adam)
  å®éªŒç»„4: Dropoutç‡è°ƒä¼˜ (Bçš„åŸºçº¿: 0.25/0.5)
  å®éªŒç»„5: æœ€ä½³ç»„åˆæ¢ç´¢
  æ€»å…±è®¾è®¡ 26 ä¸ªå®éªŒ

>>> å¯¹ç…§ç»„: Bçš„åŸºçº¿å‚æ•°

   æ­£åœ¨æµ‹è¯•: LR=0.001000, BS=32, Opt=adam, Dropout=0.25/0.5
2025-12-21 22:16:00.319552: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: SSE SSE2 SSE3 SSE4.1 SSE4.2 AVX AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
      æŠ˜1: å‡†ç¡®ç‡=0.991584, æ—¶é—´=1205.0s |       æŠ˜2: å‡†ç¡®ç‡=0.993988, æ—¶é—´=1137.2s |       æŠ˜3: å‡†ç¡®ç‡=0.992348, æ—¶é—´=988.4s | 
      â†’ å¹³å‡å‡†ç¡®ç‡: 0.992640 Â± 0.001003

âœ“ Bçš„åŸºçº¿KæŠ˜ç»“æœ: 0.992640 Â± 0.001003

>>> å®éªŒ 1: å­¦ä¹ ç‡å®éªŒ: 0.01

   æ­£åœ¨æµ‹è¯•: LR=0.010000, BS=32, Opt=adam, Dropout=0.25/0.5
      æŠ˜1: å‡†ç¡®ç‡=0.986556, æ—¶é—´=1699.4s |       æŠ˜2: å‡†ç¡®ç‡=0.985791, æ—¶é—´=1614.1s |       æŠ˜3: å‡†ç¡®ç‡=0.990818, æ—¶é—´=1880.0s | 
      â†’ å¹³å‡å‡†ç¡®ç‡: 0.987721 Â± 0.002212

>>> å®éªŒ 2: å­¦ä¹ ç‡å®éªŒ: 0.005

   æ­£åœ¨æµ‹è¯•: LR=0.005000, BS=32, Opt=adam, Dropout=0.25/0.5
      æŠ˜1: å‡†ç¡®ç‡=0.992567, æ—¶é—´=1260.1s |       æŠ˜2: å‡†ç¡®ç‡=0.982402, æ—¶é—´=1222.5s |       æŠ˜3: å‡†ç¡®ç‡=0.990927, æ—¶é—´=1226.6s | 
      â†’ å¹³å‡å‡†ç¡®ç‡: 0.988632 Â± 0.004456

>>> å®éªŒ 3: å­¦ä¹ ç‡å®éªŒ: 0.001

   æ­£åœ¨æµ‹è¯•: LR=0.001000, BS=32, Opt=adam, Dropout=0.25/0.5
      æŠ˜1: å‡†ç¡®ç‡=0.991365, æ—¶é—´=1216.2s |       æŠ˜2: å‡†ç¡®ç‡=0.993661, æ—¶é—´=1267.9s |       æŠ˜3: å‡†ç¡®ç‡=0.994753, æ—¶é—´=1167.2s | 
      â†’ å¹³å‡å‡†ç¡®ç‡: 0.993260 Â± 0.001412

>>> å®éªŒ 4: å­¦ä¹ ç‡å®éªŒ: 0.0005

   æ­£åœ¨æµ‹è¯•: LR=0.000500, BS=32, Opt=adam, Dropout=0.25/0.5
      æŠ˜1: å‡†ç¡®ç‡=0.992786, æ—¶é—´=965.9s |       æŠ˜2: å‡†ç¡®ç‡=0.994426, æ—¶é—´=1207.8s |       æŠ˜3: å‡†ç¡®ç‡=0.995190, æ—¶é—´=1206.7s | 
      â†’ å¹³å‡å‡†ç¡®ç‡: 0.994134 Â± 0.001003

>>> å®éªŒ 5: å­¦ä¹ ç‡å®éªŒ: 0.0001

   æ­£åœ¨æµ‹è¯•: LR=0.000100, BS=32, Opt=adam, Dropout=0.25/0.5
      æŠ˜1: å‡†ç¡®ç‡=0.992567, æ—¶é—´=1258.6s |       æŠ˜2: å‡†ç¡®ç‡=0.993551, æ—¶é—´=1247.2s |       æŠ˜3: å‡†ç¡®ç‡=0.993004, æ—¶é—´=1237.7s | 
      â†’ å¹³å‡å‡†ç¡®ç‡: 0.993041 Â± 0.000402

>>> å®éªŒ 6: å­¦ä¹ ç‡å®éªŒ: 5e-05

   æ­£åœ¨æµ‹è¯•: LR=0.000050, BS=32, Opt=adam, Dropout=0.25/0.5
      æŠ˜1: å‡†ç¡®ç‡=0.984916, æ—¶é—´=1226.7s |       æŠ˜2: å‡†ç¡®ç‡=0.989944, æ—¶é—´=1199.0s |       æŠ˜3: å‡†ç¡®ç‡=0.987538, æ—¶é—´=1253.3s | 
      â†’ å¹³å‡å‡†ç¡®ç‡: 0.987466 Â± 0.002053

>>> å®éªŒ 7: æ‰¹å¤§å°å®éªŒ: 8

   æ­£åœ¨æµ‹è¯•: LR=0.001000, BS=8, Opt=adam, Dropout=0.25/0.5
      æŠ˜1: å‡†ç¡®ç‡=0.993005, æ—¶é—´=2317.0s |       æŠ˜2: å‡†ç¡®ç‡=0.994863, æ—¶é—´=2274.2s |       æŠ˜3: å‡†ç¡®ç‡=0.994753, æ—¶é—´=2249.3s | 
      â†’ å¹³å‡å‡†ç¡®ç‡: 0.994207 Â± 0.000851

>>> å®éªŒ 8: æ‰¹å¤§å°å®éªŒ: 16

   æ­£åœ¨æµ‹è¯•: LR=0.001000, BS=16, Opt=adam, Dropout=0.25/0.5
      æŠ˜1: å‡†ç¡®ç‡=0.993988, æ—¶é—´=1597.7s |       æŠ˜2: å‡†ç¡®ç‡=0.993551, æ—¶é—´=2576.2s | Traceback (most recent call last):
...
tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
KeyboardInterrupt

```

# Panndelç‰ˆæœ¬
1. å…ˆæµ‹è¯•ç¯å¢ƒï¼š
bash
python test_paddle_minimal.py
2. è®­ç»ƒæ¨¡å‹ï¼š
bash
python train_cnn_paddle.py
3. è¯„ä¼°æ¨¡å‹ï¼š
bash
python evaluate_model_paddle.py
4. äº¤äº’å¼æµ‹è¯•ï¼š
bash
python test_model_paddle.py
5. è¶…å‚æ•°è°ƒä¼˜ï¼ˆæ‚¨çš„ä»»åŠ¡ï¼‰ï¼š
bash
python hyperparameter_tuning.py


